{% extends 'ecg_editor/dashboard.html' %}
{% load static %}
{% block content %}
    <div class="grid">
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                I
                <a href="#blackout-i">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-i" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                aVR
                <a href="#blackout-avr">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-avr" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V1
                <a href="#blackout-v1">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v1" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V4
                <a href="#blackout-v4">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v4" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                II
                <a href="#blackout-ii">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-ii" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                aVL
                <a href="#blackout-avl">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-avl" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V2
                <a href="#blackout-v2">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v2" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V5
                <a href="#blackout-v5">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v5" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                III
                <a href="#blackout-iii">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-iii" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                aVF
                <a href="#blackout-avf">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-avf" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V3
                <a href="#blackout-v3">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v3" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
        <div class="card bg-light mb-3" style="max-width: 20rem;">
            <div class="card-header text-white">
                V6
                <a href="#blackout-v6">
                    <i class="far fa-edit text-white"></i>
                </a>
            </div>
            <canvas id="preview-v6" style="height: 100px; width: 100%;">
                Update your browser to support HTML5 Canvas
            </canvas>
        </div>
    </div>

    <div id="blackout-i">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-i" style="border: 2px solid #000000;" onclick="lead_i.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_i.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_i.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_i.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_i.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_i.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-ii">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-ii" style="border: 2px solid #000000;" onclick="lead_ii.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_ii.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_ii.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_ii.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_ii.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_ii.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-iii">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-iii" style="border: 2px solid #000000;" onclick="lead_iii.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_iii.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_iii.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_iii.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_iii.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_iii.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-avr">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-avr" style="border: 2px solid #000000;" onclick="lead_avr.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avr.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avr.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avr.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avr.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avr.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-avl">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-avl" style="border: 2px solid #000000;" onclick="lead_avl.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avl.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avl.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avl.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avl.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avl.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary"
                   onclick="saveChanges('aVL', lead_avl)">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-avf">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-avf" style="border: 2px solid #000000;" onclick="lead_avf.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avf.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avf.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avf.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avf.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_avf.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v1">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v1" style="border: 2px solid #000000;" onclick="lead_v1.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v1.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v1.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v1.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v1.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v1.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v2">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v2" style="border: 2px solid #000000;" onclick="lead_v2.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v2.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v2.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v2.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v2.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v2.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v3">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v3" style="border: 2px solid #000000;" onclick="lead_v3.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v3.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v3.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v3.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v3.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v3.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v4">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v4" style="border: 2px solid #000000;" onclick="lead_v4.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v4.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v4.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v4.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v4.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v4.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v5">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v5" style="border: 2px solid #000000;" onclick="lead_v5.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v5.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v5.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v5.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v5.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v5.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <div id="blackout-v6">
        <div id="window" class="card" style="max-width: 50rem;">
            <p class="card-text">Изменение расположения зубцов ЭКГ</p>
            <canvas id="paint-v6" style="border: 2px solid #000000;" onclick="lead_v6.editPoints()">
                Update your browser to support HTML5 Canvas
            </canvas>
            <br>
            <div class="add-points btn-group btn-group-toggle" data-toggle="buttons">
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v6.addP()">
                    <i class="fas fa-plus add-p"></i><b class="add-p"> P</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v6.addQ()">
                    <i class="fas fa-plus add-q"></i><b class="add-q"> Q</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v6.addR()">
                    <i class="fas fa-plus add-r"></i><b class="add-r"> R</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v6.addS()">
                    <i class="fas fa-plus add-s"></i><b class="add-s"> S</b>
                </button>
                <button type="button" id="option1" class="btn btn-outline-secondary" onclick="lead_v6.addT()">
                    <i class="fas fa-plus add-t"></i><b class="add-t"> T</b>
                </button>
            </div>

            <br>
            <div class="btn-group me-2">
                <a href="#" type="button" class="btn btn-sm btn-outline-secondary">Сохранить</a>
                <a href="#" type="button" class="close-show-window btn btn-sm btn-outline-secondary">Закрыть</a>
            </div>
        </div>
    </div>

    <legend>Заключение</legend>
    <form method="post">
        <div style="display: none;">
            {{ form.patient_id }}
        </div>
        {% csrf_token %}
        <label class="col-form-label" for="inputName">ФИО:</label>
        {{ form.patient_name }}

        <label for="inputDate">Введите дату анализаа:</label>
        {{ form.date }}
        <br>
        <div class="form-check">
            <label class="form-check-label">
                {{ form.is_sinus }}
                Ритм синусовый
            </label>
        </div>
        <div class="form-check">
            <label class="form-check-label">
                {{ form.is_regular }}
                Ритм регулярный
            </label>
        </div>
        <label class="col-form-label" for="inputAxis">Положение электрической оси сердца:</label>
        {{ form.heart_axis }}
        <label for="inputReport">Заключение:</label>
        {{ form.conclusion }}
        <label for="exampleTextarea">Дополнительная информация:</label>
        {{ form.additional_info }}
        <br>
        <button type="submit" class="btn btn-warning">Сохранить</button>
    </form>
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script>

        let data = JSON.parse("{{data|escapejs}}");
        $("#inputId").val(data['patient_id']);
        $("#inputName").val(data['patient_name']);
        $("#inputDate").val(data['date']);
        $("#is_sinus").prop("checked", data['is_sinus']);
        $("#is_regular").prop("checked", data['is_regular']);
        $("#inputAxis").val(data['heart_axis']);
        $("#inputReport").val(data['conclusion']);
        $("#inputAdd").val(data['additional_info'])

        class LeadClass {
            constructor(lead, canvas) {
                this.array_ = array_from_string(lead['array']);
                this.p_ = points_from_string(lead['P'])
                this.q_ = points_from_string(lead['Q'])
                this.r_ = points_from_string(lead['R'])
                this.s_ = points_from_string(lead['S'])
                this.t_ = points_from_string(lead['T'])
                this.is_p = lead['is_P']
                this.qrs_width = lead['QRS_width']
                this.qrs_height = lead['QRS_height']
                this.r_r = lead['R_R']
                this.p_r = lead['P_R']
                this.max = getMaxOfArray(this.array_)
                this.min = getMinOfArray(this.array_)
                this.canvas = canvas
                this.height = lead['height']
                this.width = lead['width']
            }

            get Height() {
                return this.height
            }

            get Width() {
                return this.width
            }

            get array() {
                return this.array_;
            }

            get P() {
                return this.p_;
            }

            get Q() {
                return this.q_;
            }

            get R() {
                return this.r_;
            }

            get S() {
                return this.s_;
            }

            get T() {
                return this.t_;
            }

            addCustomP(x, y) {
                this.p_.push([x, y])
            }

            addCustomQ(x, y) {
                this.q_.push([x, y])
            }

            addCustomR(x, y) {
                this.r_.push([x, y])
            }

            addCustomS(x, y) {
                this.s_.push([x, y])
            }

            addCustomT(x, y) {
                this.t_.push([x, y])
            }

            printPreview(id) {
                //рисую тут превью
                let canvas = document.getElementById(id);
                let ctx = canvas.getContext("2d");
                //alert(canvas_i.width + ' ' + canvas_i.height);
                ctx.stroke();
                let delta = this.array_[0] * 2;
                let y = this.array_[0] / delta * canvas.height;
                let x = 0 / this.array_.length * canvas.width;
                //alert(x + ' ' + y)
                ctx.moveTo(x, y)
                for (let i = 1; i < this.array_.length; i++) {
                    y = this.array_[i] / delta * canvas.height;
                    x = i / this.array_.length * canvas.width;
                    ctx.lineTo(x, y);
                    ctx.stroke();
                }
                ctx.lineWidth = 0.1;
                ctx.stroke();
            }

            drawAll() {
                let ctx = this.canvas.getContext("2d");
                const width = this.canvas.width, height = this.canvas.height;
                ctx.clearRect(0, 0, width, height);
                ctx.stroke();
                ctx.moveTo(0, this.array_[0])
                for (let i = 0; i < this.array_.length; i++) {
                    ctx.lineTo(i, this.array_[i]);
                }
                ctx.lineWidth = 1;
                ctx.stroke();

                this.drawPoints(this.r_, "#000dff", ctx);
                this.drawPoints(this.q_, "#20a009", ctx);
                this.drawPoints(this.s_, "#ffb700", ctx);
                this.drawPoints(this.p_, "#ff0000", ctx);
                this.drawPoints(this.t_, "#ff00f2", ctx);
            }

            drawPoints(array_point, color, ctx) {
                for (let i = 0; i < array_point.length; i++) {
                    ctx.fillStyle = color;
                    ctx.beginPath();
                    ctx.arc(array_point[i][1], array_point[i][0], 3, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.stroke();
                }
            }

            addP() {
                this.p_.push([height / 2, width / 2]);
                this.drawAll();
            }

            addQ() {
                this.q_.push([height / 2, width / 2]);
                this.drawAll();
            }

            addR() {
                this.r_.push([height / 2, width / 2]);
                this.drawAll();
            }

            addS() {
                this.s_.push([height / 2, width / 2]);
                this.drawAll();
            }

            addT() {
                this.t_.push([height / 2, width / 2]);
                this.drawAll();
            }

            editPoints() {
                let is_hold = false;
                let is_move = false;
                let point_name = "";
                let point_index = -1;
                let mousedownFired = false;
                let outer = this;

                this.canvas.onmousedown = function (e) {
                    mousedownFired = true;
                    //alert(outer.R)
                    let i = find_near_point(outer.P, e.offsetX, e.offsetY);
                    if (i !== -1) {
                        is_hold = true;
                        point_name = "P";
                        point_index = i;
                    }
                    i = find_near_point(outer.Q, e.offsetX, e.offsetY);
                    if (i !== -1) {
                        is_hold = true;
                        point_name = "Q";
                        point_index = i;
                    }
                    i = find_near_point(outer.R, e.offsetX, e.offsetY);
                    if (i !== -1) {
                        is_hold = true;
                        point_name = "R";
                        point_index = i;
                    }
                    i = find_near_point(outer.S, e.offsetX, e.offsetY);
                    if (i !== -1) {
                        is_hold = true;
                        point_name = "S";
                        point_index = i;
                    }
                    i = find_near_point(outer.T, e.offsetX, e.offsetY);
                    if (i !== -1) {
                        is_hold = true;
                        point_name = "T";
                        point_index = i;
                    }
                };

                this.canvas.oncontextmenu = function (e) {

                };

                this.canvas.onmousemove = function (e) {
                    is_move = true;
                    if (is_hold) {
                        if (point_name === "P") {
                            //window.alert("pp")
                            outer.P[point_index][0] = e.offsetY;
                            outer.P[point_index][1] = e.offsetX;
                            outer.drawAll();
                        }
                        if (point_name === "Q") {
                            outer.Q[point_index][0] = e.offsetY;
                            outer.Q[point_index][1] = e.offsetX;
                            outer.drawAll();
                        }
                        if (point_name === "R") {
                            outer.R[point_index][0] = e.offsetY;
                            outer.R[point_index][1] = e.offsetX;
                            outer.drawAll();
                        }
                        if (point_name === "S") {
                            outer.S[point_index][0] = e.offsetY;
                            outer.S[point_index][1] = e.offsetX;
                            outer.drawAll();
                        }
                        if (point_name === "T") {
                            outer.T[point_index][0] = e.offsetY;
                            outer.T[point_index][1] = e.offsetX;
                            outer.drawAll();
                        }
                    }
                };

                this.canvas.onmouseup = function (e) {
                    is_hold = false;
                    if (!is_move) {
                        let i = find_near_point(outer.P, e.offsetX, e.offsetY);
                        if (i !== -1) {
                            outer.P.splice(i, 1);
                            outer.drawAll();
                        }
                        i = find_near_point(outer.Q, e.offsetX, e.offsetY);
                        if (i !== -1) {
                            outer.Q.splice(i, 1);
                            outer.drawAll();
                        }
                        i = find_near_point(outer.R, e.offsetX, e.offsetY);
                        if (i !== -1) {
                            outer.R.splice(i, 1);
                            outer.drawAll();
                        }
                        i = find_near_point(outer.S, e.offsetX, e.offsetY);
                        if (i !== -1) {
                            outer.S.splice(i, 1);
                            outer.drawAll();
                        }
                        i = find_near_point(outer.T, e.offsetX, e.offsetY);
                        if (i !== -1) {
                            outer.T.splice(i, 1);
                            outer.drawAll();
                        }
                    }
                    is_move = false;
                };

                this.canvas.onmouseout = function (e) {
                    is_hold = false;
                };
            }
        }

        let lead_i = new LeadClass(JSON.parse("{{lead_i|escapejs}}"), document.getElementById("paint-i"));
        lead_i.printPreview("preview-i");
        let lead_ii = new LeadClass(JSON.parse("{{lead_ii|escapejs}}"), document.getElementById("paint-ii"));
        lead_ii.printPreview("preview-ii");
        let lead_iii = new LeadClass(JSON.parse("{{lead_iii|escapejs}}"), document.getElementById("paint-iii"));
        lead_iii.printPreview("preview-iii");
        let lead_avr = new LeadClass(JSON.parse("{{lead_aVR|escapejs}}"), document.getElementById("paint-avr"));
        lead_avr.printPreview("preview-avr");
        let lead_avl = new LeadClass(JSON.parse("{{lead_aVL|escapejs}}"), document.getElementById("paint-avl"));
        lead_avl.printPreview("preview-avl");
        let lead_avf = new LeadClass(JSON.parse("{{lead_aVF|escapejs}}"), document.getElementById("paint-avf"));
        lead_avf.printPreview("preview-avf");
        let lead_v1 = new LeadClass(JSON.parse("{{lead_V1|escapejs}}"), document.getElementById("paint-v1"));
        lead_v1.printPreview("preview-v1");
        let lead_v2 = new LeadClass(JSON.parse("{{lead_V2|escapejs}}"), document.getElementById("paint-v2"));
        lead_v2.printPreview("preview-v2");
        let lead_v3 = new LeadClass(JSON.parse("{{lead_V3|escapejs}}"), document.getElementById("paint-v3"));
        lead_v3.printPreview("preview-v3");
        let lead_v4 = new LeadClass(JSON.parse("{{lead_V4|escapejs}}"), document.getElementById("paint-v4"));
        lead_v4.printPreview("preview-v4");
        let lead_v5 = new LeadClass(JSON.parse("{{lead_V5|escapejs}}"), document.getElementById("paint-v5"));
        lead_v5.printPreview("preview-v5");
        let lead_v6 = new LeadClass(JSON.parse("{{lead_V6|escapejs}}"), document.getElementById("paint-v6"));
        lead_v6.printPreview("preview-v6");

        document.getElementById("paint-i").height = lead_i['height']
        document.getElementById("paint-i").width = lead_i['width']
        document.getElementById("paint-ii").height = lead_ii['height']
        document.getElementById("paint-ii").width = lead_ii['width']
        document.getElementById("paint-iii").height = lead_iii['height']
        document.getElementById("paint-iii").width = lead_iii['width']
        document.getElementById("paint-avr").height = lead_avr['height']
        document.getElementById("paint-avr").width = lead_avr['width']
        document.getElementById("paint-avl").height = lead_avl['height']
        document.getElementById("paint-avl").width = lead_avl['width']
        document.getElementById("paint-avf").height = lead_avf['height']
        document.getElementById("paint-avf").width = lead_avf['width']
        document.getElementById("paint-v1").height = lead_v1['height']
        document.getElementById("paint-v1").width = lead_v1['width']
        document.getElementById("paint-v2").height = lead_v2['height']
        document.getElementById("paint-v2").width = lead_v2['width']
        document.getElementById("paint-v3").height = lead_v3['height']
        document.getElementById("paint-v3").width = lead_v3['width']
        document.getElementById("paint-v4").height = lead_v4['height']
        document.getElementById("paint-v4").width = lead_v4['width']
        document.getElementById("paint-v5").height = lead_v5['height']
        document.getElementById("paint-v5").width = lead_v5['width']
        document.getElementById("paint-v6").height = lead_v6['height']
        document.getElementById("paint-v6").width = lead_v6['width']

        lead_i.drawAll();
        lead_ii.drawAll();
        lead_iii.drawAll();
        lead_avr.drawAll();
        lead_avl.drawAll();
        lead_avf.drawAll();
        lead_v1.drawAll();
        lead_v2.drawAll();
        lead_v3.drawAll();
        lead_v4.drawAll();
        lead_v5.drawAll();
        lead_v6.drawAll();

        function find_near_point(array, x, y) {
            for (let i = 0; i < array.length; i++) {
                if (Math.abs(array[i][0] - y) < 5 && Math.abs(array[i][1] - x) < 5) {
                    return i;
                }
            }
            return -1;
        }


        function array_from_string(string) {
            let new_array = [];
            for (let i = 1; i < string.length; i++) {
                if (string[i] === '[') {
                    let y;
                    y = parseInt(string.substring(i + 1, i + 6), 10);
                    new_array.push(y);
                }
            }
            return new_array;
        }

        function points_from_string(string) {
            let new_array = [];
            for (let i = 1; i < string.length; i++) {
                if (string[i] === '[') {
                    let point = []
                    let y = parseInt(string.substring(i + 1, i + 6), 10);
                    point.push(y);
                    while (string[i] !== ',') {
                        i++;
                    }
                    let x = parseInt(string.substring(i + 1, i + 6), 10);
                    point.push(x);
                    new_array.push(point);
                }
            }
            return new_array;
        }

        function getMaxOfArray(numArray) {
            return Math.max.apply(null, numArray);
        }

        function getMinOfArray(numArray) {
            return Math.min.apply(null, numArray);
        }

        function saveChanges(name, lead) {
            let xhr = new XMLHttpRequest();
            xhr.open('PATCH', 'http://127.0.0.1:8000/ecg_editor/result', false);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            let json_r = JSON.stringify(lead.R)
            let json_p = JSON.stringify(lead.P)
            let json_q = JSON.stringify(lead.Q)
            let json_s = JSON.stringify(lead.S)
            let json_t = JSON.stringify(lead.T)
            const body = 'name=' + encodeURIComponent(name) + '&json_r=' + encodeURIComponent(json_r)
            + '&json_p=' + encodeURIComponent(json_p) + '&json_q=' + encodeURIComponent(json_q)
            + '&json_s=' + encodeURIComponent(json_s) + '&json_t=' + encodeURIComponent(json_t);
            xhr.send(body);
            if (xhr.status !== 200) {
                alert(xhr.status + ': ' + xhr.statusText);
            } else {
                alert("ВСе океюшки");
            }
        }

    </script>
{% endblock %}